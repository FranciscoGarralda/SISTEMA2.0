--- a/netlify/functions/utils/auth.js
+++ b/netlify/functions/utils/auth.js
@@ -4,7 +4,7 @@ import bcrypt from 'bcryptjs';
 
 // Clave secreta para JWT (en producción, usar variables de entorno)
-const JWT_SECRET = process.env.JWT_SECRET || 'your-secret-key-change-in-production';
+const JWT_SECRET = process.env.JWT_SECRET || (process.env.NODE_ENV === 'production' ? null : 'dev-secret-key-change-in-production');
 
 // Generar token JWT
 export function generateToken(user) {
@@ -12,6 +12,11 @@ export function generateToken(user) {
   const { password, ...userWithoutPassword } = user;
   
   return jwt.sign(
     { user: userWithoutPassword },
     JWT_SECRET,
-    { expiresIn: '24h' }
+    { 
+      expiresIn: '24h',
+      issuer: 'sistema-financiero',
+      audience: 'sistema-financiero-users'
+    }
   );
 }
 
@@ -19,6 +24,11 @@ export function generateToken(user) {
 // Verificar token JWT
 export function verifyToken(token) {
   try {
+    // Verificar que JWT_SECRET esté configurado en producción
+    if (!JWT_SECRET && process.env.NODE_ENV === 'production') {
+      throw new Error('JWT_SECRET no configurado en producción');
+    }
+    
     return jwt.verify(token, JWT_SECRET);
   } catch (error) {
     return null;
